{
	"version": "0.1",
	"name": "Authzed",
	"scopeName": "source.authzed",
  "foldingStartMarker": "\\{\\s*$",
  "foldingStopMarker": "^\\s*\\}",
	"patterns": [
    { "include": "#comment" },
    { "include": "#operator" },
    { "include": "#class" }
	],
	"repository": {
    "comment": {
      "patterns": [
        { "include": "#lineComment" },
        { "include": "#blockComment" }
      ],
      "repository": {
        "lineComment": {
          "patterns": [
            { "include": "#doubleSlashLineComment" },
            { "include": "#slashDotLineComment" }
          ],
          "repository": {
            "doubleSlashLineComment": {
              "match": "\\/\\/.*",
              "name": "comment.line.double-slash.authzed"
            },
            "slashDotLineComment": {
              "match": "\\/\\*.*\\*\\/",
              "name": "comment.line.authzed"
            }
          }
        },
        "blockComment": {
          "begin": "\\/\\*",
          "end": "\\*\\/",
          "name": "comment.block.authzed"
        }
      }
    },
    "operator": {
      "comment": "= equal, : assign, | or, + union, & intersection, - exclusion, -> arrow, == comparison",
      "patterns": [
        { "include": "#equal" },
        { "include": "#assign" },
        { "include": "#or" },
        { "include": "#union" },
        { "include": "#intersection" },
        { "include": "#exclusion" },
        { "include": "#arrow" },
        { "include": "#comparison" }
      ],
      "repository": {
        "equal": {
          "match": "\\s=\\s",
          "name": "keyword.operator.equal.authzed"
        },
        "assign": {
          "match": ":\\s",
          "name": "keyword.operator.equal.authzed"
        },
        "or": {
          "match": "\\s|\\s",
          "name": "keyword.operator.or.authzed"
        },
        "union": {
          "match": "\\s+\\s",
          "name": "keyword.operator.union.authzed"
        },
        "intersection": {
          "match": "\\s&\\s",
          "name": "keyword.operator.intersection.authzed"
        },
        "exclusion": {
          "match": "\\s-\\s",
          "name": "keyword.operator.exclusion.authzed"
        },
        "arrow": {
          "match": "(->)",
          "name": "keyword.operator.arrow.authzed"
        },
        "comparison": {
          "match": "\\s==\\s",
          "name": "keyword.operator.comparison.authzed"
        }
      }
    },
    "class": {
      "comment": "Object Definitions are similar to a class definition in an Object Oriented programming language.",
      "patterns": [
        { "include": "#definition" },
        { "include": "#relation" },
        { "include": "#permission" }
      ],
      "repository": {
        "definition": {
          "match": "^(definition|caveat)\\s",
          "name": "keyword.control.class.authzed"
        },
        "relation": {
          "match": "^\\s{1,4}relation\\s",
          "name": "entity.name.type.authzed"
        },
        "permission": {
          "match": "^\\s{1,4}permission\\s",
          "name": "entity.name.function.authzed"
        }
      }
    }
  }
}
